NeMu: 神经肌肉模型笔记
包含一份简短的描述和一个数学模型
数学模型描述了在自愿等长收缩期间产生sEMG和力的机制

1、运动神经元池模型
（1）运动单元的招募模式
    这部分模型生成了运动神经元池的静态输入-输出关系。
    采用了Fuglevand等人（1993）的现象学模型，其中将运动单元池的共同驱动映射到运动单元放电率。这种映射的关键是运动单元招募模式。
    每个MU包含一个运动神经元及其支配的肌纤维。在该模型中，包括了三种类型的MU：
    （a）I型（S型）：低阈值MUs，具有收缩速度缓慢的肌纤维
    （b）IIa型（FR型）：招募阈值高于I型的MUs，具有收缩速度快且抗疲劳的肌纤维
    （c）IIb型（FF型）：招募阈值最高的MUs，具有收缩速度快但易疲劳的肌纤维
    
🕐 招募范围（MU在不同激活阈值下的招募范围）
    用于定义每个MU的招募阈值兴奋
    
    RTE_i=exp(ln(rr)i/n)
    
    RTE_i：第i个MU的招募阈值兴奋（激活MU所需的兴奋水平）
    rr：招募范围
    i：MU的编号
    n：总MUs数量
    
🕑MU放电率和兴奋驱动之间的关系（直接和成比例的，兴奋驱动☝，MU招募和放电率☝）
    MU放电率：MU产生动作电位并随后引起肌肉收缩的速率，即单位时间内产生动作电位的频率
    兴奋驱动：来自中枢神经系统的兴奋或刺激水平，常通过大脑和脊髓的下行通路传递
    定义每个MU的放电率『兴奋（共同）驱动的函数』
    
    if e(t)>=RTE_i, fr_i(t)=g_i(e(t)-RTE_i)+MFR
    else fr_i(t)=0
    
    e(t)：兴奋（共同）驱动的时间函数
    fr_i(t)：第i个MU的在t时刻的平均放电率
    MFR：最小放电率
    PFR_i：第i个MU的峰值放电率
    
    PFR_i=PFR_1-PFRD(RTE_i/RTE_n)
    
    PFRD：运动神经元池中第一个和最后一个招募的MU的峰值放电率之间的差值
    
    g_i：第i个MU的兴奋驱动和放电率之间关系的增益
    
    g_i=g_f(i)(PFR_i-MFR)/(e_max-RTE_i)
    e_max=RTE_n/e_LR
    
    e_max：运动神经元池的最大兴奋驱动
    e_LR：招募最后一个MU的兴奋驱动的归一化值（由e_max归一化）
    g_f(i)：i的函数，返回在增益因子g_1和1区间内均匀分布的n（总MUs数量）个数字
    
    如果设置 所有MUs的增益相同，则g_i=g_n
    
    g_i=(PFR_n-MFR)/(e_max-RTE_n)
    
    欲了解更多关于MUs生理学的信息，请参阅Kernell（2006）的专著
    
（2）定义兴奋（共同）驱动
    共同驱动和MU的招募模式（如上所述）用于生成MUSTs。MUSTs将控制肌纤维产生肌肉力和MEG
    不同的力强度（最大力的百分比）可以用梯形（Trapezoidal）或者正弦（Sinusoidal）函数来实现。模拟稳定的等长收缩，可以选择梯形函数，将Plateau on设置为0，Plateau off设置为最终模拟时间
    可以使用梯形函数观察MU的招募和去招募，但是在这种情况下，参数Onset的值应该小于Plateau on，Offset应该小于Plateau off
    周期收缩可以通过改变函数为正弦波来模拟，参数包括：Peak Intensity（峰值强度）和Frequency（频率）
    
（3）运动单元脉冲序列
    MU活动（脉冲序列）类似于高斯分布的随机点过程。Fuglevand（1993）等人的模型将峰值时间模拟为：
    
    t_ij=miu+theta.Z+t_(ij-1)
    
    t_ij：第i个MU的第j个放电（脉冲）时间
    miu：平均峰间间隔（ISI）
    theta：每个峰间间隔ISI的标准差，是变异系数（cv）的函数，theta=miu.cv
    Z：表示放电时间如何偏离平均值（高斯分布中介于-3.9和3.9之间的随机值）
    
🕐运动单元同步
    汇聚到脊髓运动神经元的突触前指令促进了这些细胞膜电位的共同波动，这些共同源增加了MUs同步放电的概率（可能性），即所谓的MU同步
    为了模拟这一现象，采用了Yao等人的模型。为了处理时变的兴奋（梯形和正弦），在算法中增加了一个额外的步骤。根据Shin（2018）等人提出的方案，同步过程仅限于发生在最大时间间隔（15ms）内的放电时间。
    
    Synch.Level [%]的操作如下：
    （a）对于池中的每个MU，随机选择一定比例的脉冲时间作为脉冲调整的参考；
    （b）给定一个参考脉冲，算法选择一定比例的已招募MUs，并找到与参考脉冲距离最近的放电时间进行调整（即参考脉冲与所选的MUs的所有其他脉冲之间放电时间的距离最小）；
    （c）步骤b选定的脉冲时间调整为参考脉冲。参数Synch.theta [ms]引入少量的变化，因此参考脉冲时间为均值，而Synch.theta [ms]为高斯分布的标准差。
    
2、表面肌电信号
    sEMG由肌纤维在特定收缩期间的电活动产生。穿过肌纤膜（肌膜）的电流（肌纤维动作电位引起的）产生的电位可以通过细胞外电极记录下来。记录到的细胞外电位经过包括肌肉、脂肪和皮肤组织的体积导体进行空间滤波。值得注意的是，MU区域在肌肉横截面上是稀疏分布的。
（1）肌肉横截面形态
    四种不同的肌肉横截面形态：Circle（圆形）、Ring（环形）、Pizza（批萨形）和Ellipse（椭圆形）
    需要调整横截面积（CSA）、脂肪厚度（Fat layer[mm]）、皮肤厚度（Skin layer[mm]）等属性
    对于环形、批萨形和椭圆形形态，还需要调整两个额外的参数：
    （a）比例（Propotion）：环形——定义内外肌肉半径的比例；椭圆形——定义短轴和长轴的比例
    （b）弧度（theta[rad]）：定义所选几何形态的“opening”，即经过原点的垂线和经过原点的肌肉横截面的边界线之间形成的夹角
    
（2）肌肉横截面积内的运动单元分布
    许多人类肌肉在肌肉横截面积内呈现某种程度的MU区域化（Johnson et al.，1973）。为了模拟这种MU区域化，定义了两种不同的分布，一种用于支配I型肌纤维的MUs，另一种用于支配II型肌纤维的MUs。每个MU的位置使用极坐标定义。所有MUs的极角由一个均匀分布的随机变量定义，其范围取决于所选择的肌肉横截面形态。每个MU的径向坐标定义为一个服从高斯分布的随机变量。
    径向坐标的分布由变量Type I miu（使用肌肉外半径归一化）调整，该变量定义了I型MUs的分布中心（平均值）。同样，Type II miu和Type II theta分别定义了II型（a和b）MUs的分布中心（平均值）和标准差（均使用肌肉外半径归一化）。
    
    
🕐肌纤维比例
    MU区域面积与单个运动神经元支配的肌纤维数量高度相关，且跨运动神经元池不同（Enoka and Fuglevand 2001）。典型的骨骼肌包括较多支配较少肌纤维的MUs和较少支配较多肌纤维的MUs。运动神经元池的MU神经支配比例可以建模为：
    
    y_i=y_1✖exp(ln(R_in)i/n)
    
    y_i：第i个MU支配的肌纤维数量
    y_1：最小MU支配的肌纤维数量
    n：总MUs数量
    R_in：最大和最小MU之间的神经支配比例（Innervation ratio）
    
（3）运动单元动作电位
    从皮肤表面的双极电极观察到的MU动作电位可以用一阶和二阶Hermite-Rodriguez（HR）函数表示（Lo Conte et al.，1994）。这些函数符合MUAPs的形状，已经在先前的研究中使用过。一阶HR函数模拟双相MUAPs，而二阶HR函数模拟三相MUAPs。由以下方程定义：
    
    HR1(t)=(A_M.(t-t_AP)/lamda_M)✖exp(-((t-t_AP)/lamda_M)^2)✖u(t-t_AP)
    
    HR2(t)=(A_M.(1-2((t-t_AP)/lamda_M)^2)✖exp(-((t-t_AP)/lamda_M)^2)✖u(t-t_AP)
    
    HRk：k阶HR函数
    A_M：振幅因子
    lamda_M：持续时间因子
    t：模拟时间
    t_AP：运动单元放电时间
    u：Heaviside函数（阶跃函数）

    每个MU具有不同的振幅和持续时间因子。为了定义每个MUAP的振幅因子，在First MUAP Amplitude [mV]和Last MUAP Amplitude [mV]之间使用指数插值。采用相同的方法定义每个MUAP的持续时间因子。
    
    在本模型中，MUAPs可以用一阶或二阶HR函数表示，随机（等概率）分配给MUs。
    
（4）体积导体（空间滤波）
   体积导体（由肌肉、脂肪和皮肤组织表征）的滤波效应建模为各向同性的，并与MU区域中心和皮肤表面电极之间的距离成正比。使用以下方程（Cisi和Kohn 2008）对体积导体的空间滤波导致的幅度衰减和MUAP加宽进行建模：
   
   V=V_0exp(-d/T_at)
   T=T_0(1+Cd)
   
   V：表面电极记录的MUAP振幅
   V_0：MU区域中心的MUAP振幅
   d：MU区域中心和双极EMG传感器中心之间的距离
   T_at：Amplitude Attenuation Factor [mm^-1]
   T：电极上MUAP的持续时间
   T_0：MU区域中心的MUAP持续时间
   C：MUAP Widening Factor [mm^-1]
   
（5）sEMG的生成
    sEMG建模为已招募的MUs的所有经过滤波的MUAP序列的活动总和。
    为了模拟实验记录，可以将加性高斯噪声叠加到模型生成的sEMG信号中。这种干扰噪声的幅度由Noise standard deviation [mV]参数调节。此外，将一个四阶巴特沃斯带通滤波器应用于sEMG信号，表示采集设备中存在抗混叠滤波器。High-pass cutoff frequency [Hz]和Low-pass cutoff frequency [Hz]分别定义了滤波器的低频和高频截至频率。
（6）sEMG信号分析

3、肌肉力
（1）MU抽搐力
（2）MU强直力
（3）肌肉力的生成
（4）肌肉力信号分析

4、保存仿真结果



